<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∏‡∏î | Lumina Shabu</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        /* Animation ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏î‡πâ‡∏á */
        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.7); }
            70% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(255, 215, 0, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 215, 0, 0); }
        }

        /* üïäÔ∏è Animation ‡∏ô‡∏Å‡∏û‡∏¥‡∏£‡∏≤‡∏ö (Dove Effect) */
        .dove-particle {
            position: fixed;
            font-size: 24px;
            pointer-events: none;
            z-index: 9999;
            animation: flyUp 1.2s ease-out forwards;
            filter: drop-shadow(0 0 5px white);
        }
        @keyframes flyUp {
            0% { transform: translate(-50%, -50%) scale(0.5) rotate(0deg); opacity: 0; }
            20% { opacity: 1; }
            100% { transform: translate(-50%, -150px) scale(1.5) rotate(-20deg); opacity: 0; }
        }
    </style>
</head>

<body class="menu-bg">

    <div class="moonlight-container">
        <div class="moonlight" style="top:15%;left:10%"></div>
        <div class="moonlight" style="top:60%;left:70%"></div>
    </div>
    <div class="petal-container"></div>

    <div id="closedModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:9999; justify-content:center; align-items:center; text-align:center; color:white; flex-direction: column;">
        <div>
            <h1 style="font-size:3rem; margin-bottom: 20px;">üïäÔ∏è ‡∏£‡πâ‡∏≤‡∏ô‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö</h1>
            <p style="font-size:1.2rem;">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏≠‡∏∏‡∏î‡∏´‡∏ô‡∏∏‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏à‡∏≠‡∏Å‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞!</p>
            <button onclick="location.href='index.html'" style="margin-top:20px; padding:10px 20px; background:white; color:black; border:none; border-radius:50px; cursor:pointer;">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
        </div>
    </div>

    <div id="leaderModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); z-index:9998; justify-content:center; align-items:center;">
        <div style="background: white; width: 90%; max-width: 350px; border-radius: 15px; padding: 25px; text-align: center; position: relative; box-shadow: 0 0 20px rgba(108, 92, 231, 0.3);">
            <span onclick="document.getElementById('leaderModal').style.display='none'" style="position:absolute; top:10px; right:15px; font-size:2rem; cursor:pointer; color:#888;">&times;</span>
            <h2 style="color:#6c5ce7; margin-bottom:20px; font-family:'Sarabun', sans-serif;">üèÜ ‡∏´‡πâ‡∏≠‡∏á‡πÑ‡∏´‡∏ô‡∏Ñ‡∏∑‡∏≠ No.1?</h2>
            <div id="leaderContent" style="text-align:left; min-height: 100px;">
                ‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...
            </div>
        </div>
    </div>

    <div class="menu-container page-content">

        <button class="back-btn" onclick="location.href='index.html'">‚Üê Home</button>

        <h2 class="menu-title">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∏‡∏î</h2>

        <div style="text-align: center; margin-bottom: 25px; display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;">
            <button onclick="randomMenu()" style="background: linear-gradient(45deg, #FFD700, #FF8C00); border: none; padding: 10px 20px; border-radius: 50px; color: white; font-weight: bold; font-size: 0.9rem; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4); cursor: pointer; animation: pulse 2s infinite;">
                üé≤ ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π
            </button>
            <button onclick="showLeaderboard()" style="background: linear-gradient(45deg, #6c5ce7, #a29bfe); border: none; padding: 10px 20px; border-radius: 50px; color: white; font-weight: bold; font-size: 0.9rem; box-shadow: 0 4px 15px rgba(108, 92, 231, 0.4); cursor: pointer;">
                üèÜ ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏´‡πâ‡∏≠‡∏á
            </button>
        </div>

        <div class="menu-card" onclick="goOrder('A')">
            <span class="moon">üåô</span>
            <div class="menu-text">
                <h3>SET A : Crescent Moon</h3>
                <p><b>‡∏ä‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î</b> ¬∑ 39 ‡∏ö‡∏≤‡∏ó</p>
                <small>‡πÄ‡∏™‡πâ‡∏ô + ‡∏ú‡∏±‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô, ‡∏´‡∏°‡∏π‡πÄ‡∏î‡πâ‡∏á 3 ‡∏Å‡πâ‡∏≠‡∏ô, ‡πÑ‡∏Ç‡πà‡∏ï‡πâ‡∏°‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏ü‡∏≠‡∏á</small>
            </div>
        </div>

        <div class="menu-card recommend" onclick="goOrder('B')">
            <span class="moon">üåô‚≠ê</span>
            <div class="menu-text">
                <h3>SET B : Half Moon</h3>
                <p><b>‡∏ä‡∏∏‡∏î‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</b> ‚≠ê ¬∑ 49 ‡∏ö‡∏≤‡∏ó</p>
                <small>‡πÄ‡∏™‡πâ‡∏ô + ‡∏ú‡∏±‡∏Å, ‡∏´‡∏°‡∏π‡πÄ‡∏î‡πâ‡∏á 2 ‡∏Å‡πâ‡∏≠‡∏ô, ‡∏´‡∏°‡∏π‡∏™‡πÑ‡∏•‡∏î‡πå 3‚Äì4 ‡∏ä‡∏¥‡πâ‡∏ô, ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å‡πÑ‡∏Å‡πà</small>
            </div>
        </div>

        <div class="menu-card" onclick="goOrder('C')">
            <span class="moon">üåï</span>
            <div class="menu-text">
                <h3>SET C : Full Moon</h3>
                <p><b>‡∏ä‡∏∏‡∏î‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏à‡∏±‡∏î‡πÄ‡∏ï‡πá‡∏°</b> ¬∑ 59 ‡∏ö‡∏≤‡∏ó</p>
                <small>‡πÄ‡∏™‡πâ‡∏ô + ‡∏ú‡∏±‡∏Å, ‡∏´‡∏°‡∏π‡∏™‡πÑ‡∏•‡∏î‡πå (‡πÄ‡∏¢‡∏≠‡∏∞‡∏û‡∏¥‡πÄ‡∏®‡∏©), ‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ‡∏ä‡∏µ‡∏™, ‡πÑ‡∏Ç‡πà‡∏ï‡πâ‡∏° 1 ‡∏ü‡∏≠‡∏á</small>
            </div>
        </div>

        <div style="margin: 40px 0 20px 0; display: flex; align-items: center; gap: 10px; opacity: 0.8;">
            <div style="height: 1px; background: #ccc; flex: 1;"></div>
            <span style="color: #666; font-weight: bold;">üç° ‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏≤‡∏ô‡πÄ‡∏•‡πà‡∏ô (Shabu Cup)</span>
            <div style="height: 1px; background: #ccc; flex: 1;"></div>
        </div>

        <div class="menu-card" onclick="goOrder('CUP_A')" style="border-left: 5px solid #a8c0ff;">
            <span class="moon">üïäÔ∏è</span>
            <div class="menu-text">
                <h3>Cup A : Pale Dove</h3>
                <p><b>‡∏ã‡∏∏‡∏õ‡∏ô‡πâ‡∏≥‡πÉ‡∏™</b> ¬∑ 19 ‡∏ö‡∏≤‡∏ó</p>
                <small>‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏Å‡πâ‡∏ß‡∏°‡∏µ‡πÅ‡∏Ñ‡πà‡∏ô‡πâ‡∏≥‡∏ã‡∏∏‡∏õ‡∏Å‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πà‡∏°‡πÉ‡∏´‡πâ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏≠‡∏á‡πÄ‡∏•‡∏¢</small>
            </div>
        </div>

        <div class="menu-card" onclick="goOrder('CUP_B')" style="border-left: 5px solid #ff6b6b;">
            <span class="moon">üåë</span>
            <div class="menu-text">
                <h3>Cup B : Crimson Moon</h3>
                <p><b>‡∏ã‡∏∏‡∏õ‡∏´‡∏°‡∏≤‡∏•‡πà‡∏≤</b> üå∂Ô∏è ¬∑ 10 ‡∏ö‡∏≤‡∏ó</p>
                <small>‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏Å‡πâ‡∏ß‡∏°‡∏µ‡πÅ‡∏Ñ‡πà‡∏ô‡πâ‡∏≥‡∏ã‡∏∏‡∏õ‡∏Å‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πà‡∏°‡πÉ‡∏´‡πâ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏≠‡∏á‡πÄ‡∏•‡∏¢</small>
            </div>
        </div>

        <div class="menu-card" onclick="goOrder('CUP_C')" style="border-left: 5px solid #485563;">
            <span class="moon">üåå</span>
            <div class="menu-text">
                <h3>Cup C : Eternal Dream</h3>
                <p><b>‡∏ã‡∏∏‡∏õ‡∏ô‡πâ‡∏≥‡∏î‡∏≥</b> ¬∑ 19 ‡∏ö‡∏≤‡∏ó</p>
                <small>‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏Å‡πâ‡∏ß‡∏°‡∏µ‡πÅ‡∏Ñ‡πà‡∏ô‡πâ‡∏≥‡∏ã‡∏∏‡∏õ‡∏Å‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πà‡∏°‡πÉ‡∏´‡πâ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏≠‡∏á‡πÄ‡∏•‡∏¢</small>
            </div>
        </div>

    </div> 

    <script>
        // 1. ‡πÄ‡∏ä‡πá‡∏Ñ Login
        if (!sessionStorage.getItem("role")) {
            location.href = "login.html";
        }

        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbym7JvkK8GzTeyZ_By8a0Hh0qupyR0mDbX869jwaBsBHMlM44f_TSaCSvh04RcA-iIR/exec'; 
        let menuData = {};

        // üöÄ STEP 1: ‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡πâ‡∏≤‡∏ô‡∏à‡∏≤‡∏Å Cache (‡πÄ‡∏£‡πá‡∏ß)
        const cachedData = localStorage.getItem("menuData");
        if (cachedData) {
            console.log("üöÄ Fast Check: ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞");
            const data = JSON.parse(cachedData);
            menuData = data; 
            if (data.status === "CLOSED") {
                document.getElementById("closedModal").style.display = "flex";
            }
        }

        // üåê STEP 2: ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á (‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï)
        fetch(SCRIPT_URL + "?type=menu")
        .then(res => res.json())
        .then(data => {
            console.log("üåê ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß");
            menuData = data;
            localStorage.setItem("menuData", JSON.stringify(data)); 

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡πâ‡∏≤‡∏ô
            if (data.status === "CLOSED") {
                document.getElementById("closedModal").style.display = "flex";
            } else {
                document.getElementById("closedModal").style.display = "none";
            }
        })
        .catch(err => console.error("‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"));

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô 1: ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π ---
        function randomMenu() {
            if (!menuData.sets) return alert("‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•... ‡πÉ‡∏à‡πÄ‡∏¢‡πá‡∏ô‡πÜ ‡∏ô‡∏∞‡∏ß‡∏±‡∏¢‡∏£‡∏∏‡πà‡∏ô");
            const keys = Object.keys(menuData.sets);
            const randomKey = keys[Math.floor(Math.random() * keys.length)];
            const item = menuData.sets[randomKey];

            if(confirm(`‚ú® ‡∏î‡∏ß‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏û‡∏á‡∏®‡πå‡∏Å‡∏±‡∏ö...\n\nüëâ ${item.name} üëà\n\n‡∏à‡∏∞‡∏£‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏ô‡∏µ‡πâ‡πÄ‡∏•‡∏¢‡πÑ‡∏´‡∏°?`)) {
                goOrder(randomKey);
            }
        }

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô 2: ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏±‡πà‡∏á ---
        function goOrder(setId) {
            localStorage.setItem("selectedSet", setId);
            window.location.href = "order.html";
        }

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô 3: ‡∏à‡∏±‡∏î‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏´‡πâ‡∏≠‡∏á (Leaderboard) ---
        function showLeaderboard() {
            document.getElementById("leaderModal").style.display = "flex";
            document.getElementById("leaderContent").innerHTML = "<p style='text-align:center'>‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏≠‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏î‡∏π‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô...</p>";
            
            fetch(SCRIPT_URL + "?type=leaderboard")
            .then(res => res.json())
            .then(data => {
                let html = '<table style="width:100%; border-collapse:collapse;">';
                data.forEach((item, index) => {
                    let rank = index + 1;
                    let medal = rank === 1 ? "ü•á" : (rank === 2 ? "ü•à" : (rank === 3 ? "ü•â" : rank + "."));
                    let color = rank === 1 ? "#d35400" : "#333"; 
                    let bg = rank === 1 ? "background:linear-gradient(90deg, #fff9c4, white);" : "";
                    
                    html += `<tr style="border-bottom:1px solid #eee; ${bg}">
                        <td style="padding:12px; font-size:1.5rem;">${medal}</td>
                        <td style="padding:12px; font-weight:bold; color:${color}; font-size:1.1rem;">‡∏´‡πâ‡∏≠‡∏á ${item.cls}</td>
                        <td style="padding:12px; text-align:right; font-weight:bold;">${item.count} ‡∏ñ‡πâ‡∏ß‡∏¢</td>
                    </tr>`;
                });
                html += '</table>';
                
                if(data.length === 0) html = "<p style='text-align:center; color:#888;'>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô...</p>";
                document.getElementById("leaderContent").innerHTML = html;
            });
        }

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô 4: ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏ô‡∏Å‡∏û‡∏¥‡∏£‡∏≤‡∏ö‡∏ï‡∏≠‡∏ô‡∏Å‡∏î ---
        document.addEventListener('click', function(e) {
            // ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏ô‡∏Å‡∏ñ‡πâ‡∏≤‡∏Å‡∏î‡πÉ‡∏ô Modal
            if(e.target.closest('#leaderModal') || e.target.closest('#closedModal')) return;

            const dove = document.createElement('div');
            dove.className = 'dove-particle';
            dove.innerHTML = 'üïäÔ∏è'; 
            dove.style.left = e.clientX + 'px';
            dove.style.top = e.clientY + 'px';
            document.body.appendChild(dove);
            setTimeout(() => { dove.remove(); }, 1200);
        });
    </script>

    <script src="js/app.js"></script>
</body>

</html>

